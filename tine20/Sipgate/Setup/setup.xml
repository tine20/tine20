<?xml version="1.0" encoding="utf-8"?>
<application>
    <name>Sipgate</name>
    <version>2.1</version>
    <order>25</order>
    <depends>
        <application>Admin</application>
        <application>Addressbook</application>
    </depends>
    <tables>
        <table>
            <name>sipgate_account</name>
            <version>0</version>
            <declaration>
                <field>
                    <name>id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>accounttype</name>
                    <type>text</type>
                    <length>10</length>
                    <notnull>true</notnull>
                    <default>plus</default>
                </field>
                <field>
                    <name>type</name>
                    <type>text</type>
                    <length>10</length>
                    <notnull>true</notnull>
                    <default>shared</default>
                </field>
                <field>
                    <name>credential_id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>false</notnull>
                </field>
                <field>
                    <name>description</name>
                    <type>text</type>
                    <length>64</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>username</name>
                    <type>text</type>
                    <length>64</length>
                    <notnull>false</notnull>
                </field>
                <field>
                    <name>password</name>
                    <type>text</type>
                    <length>64</length>
                    <notnull>false</notnull>
                </field>
                <field>
                    <name>is_valid</name>
                    <type>boolean</type>
                    <default>false</default>
                </field>
                <field>
                    <name>created_by</name>
                    <type>text</type>
                    <length>40</length>
                </field>
                <field>
                    <name>creation_time</name>
                    <type>datetime</type>
                </field> 
                <field>
                    <name>last_modified_by</name>
                    <type>text</type>
                    <length>40</length>
                </field>
                <field>
                    <name>last_modified_time</name>
                    <type>datetime</type>
                </field>
                <field>
                    <name>is_deleted</name>
                    <type>boolean</type>
                    <default>false</default>
                </field>
                <field>
                    <name>deleted_by</name>
                    <type>text</type>
                    <length>40</length>
                </field>            
                <field>
                    <name>deleted_time</name>
                    <type>datetime</type>
                </field>
                <field>
                    <name>mobile_number</name>
                    <type>text</type>
                    <length>64</length>
                </field>
                <index>
                    <name>id</name>
                    <primary>true</primary>
                    <field>
                        <name>id</name>
                    </field>
                </index>
            </declaration>
        </table>
        <table>
            <name>sipgate_line</name>
            <version>1</version>
            <declaration>
                <field>
                    <name>id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>account_id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>true</notnull>
                </field> 
                <field>
                    <name>user_id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>false</notnull>
                </field>
                <field>
                    <name>uri_alias</name>
                    <type>text</type>
                    <length>255</length>
                </field>
                <field>
                    <name>sip_uri</name>
                    <type>text</type>
                    <length>255</length>
                </field>
                <field>
                    <name>e164_out</name>
                    <type>text</type>
                    <length>255</length>
                </field>
                <field>
                    <name>e164_in</name>
                    <type>text</type>
                    <length>255</length>
                </field>
                <field>
                    <name>tos</name>
                    <type>text</type>
                    <length>10</length>
                </field>
                <field>
                    <name>creation_time</name>
                    <type>datetime</type>
                </field>
                <field>
                    <name>last_sync</name>
                    <type>datetime</type>
                </field>
                <index>
                    <name>id</name>
                    <primary>true</primary>
                    <field>
                        <name>id</name>
                    </field>
                </index>
                <index>
                    <name>sipgate_line::account_id--sipgate_account::id</name>
                    <field>
                        <name>account_id</name>
                    </field>
                    <foreign>true</foreign>
                    <reference>
                        <table>sipgate_account</table>
                        <field>id</field>
                    </reference>
                </index>
                <index>
                    <name>sipgate_line::user_id--sipgate_user::id</name>
                    <field>
                        <name>user_id</name>
                    </field>
                    <foreign>true</foreign>
                    <reference>
                        <table>accounts</table>
                        <field>id</field>
                    </reference>
                </index>
            </declaration>
        </table>
        <table>
            <name>sipgate_connection</name>
            <version>1</version>
            <declaration>
                <field>
                    <name>id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>entry_id</name>
                    <type>text</type>
                    <length>40</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>tos</name>
                    <type>text</type>
                    <length>10</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>local_uri</name>
                    <type>text</type>
                    <length>255</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>remote_uri</name>
                    <type>text</type>
                    <length>255</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>local_number</name>
                    <type>text</type>
                    <length>128</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>remote_number</name>
                    <type>text</type>
                    <length>128</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>status</name>
                    <type>text</type>
                    <length>8</length>
                    <notnull>true</notnull>
                </field>
                <field>
                    <name>line_id</name>
                    <type>text</type>
                    <length>40</length>
                </field>
                <field>
                    <name>timestamp</name>
                    <type>datetime</type>
                </field>
                <field>
                    <name>creation_time</name>
                    <type>datetime</type>
                </field> 
                <field>
                    <name>tarif</name>
                    <type>text</type>
                    <length>255</length>
                </field>
                <field>
                    <name>duration</name>
                    <type>integer</type>
                </field>
                <field>
                    <name>units_charged</name>
                    <type>integer</type>
                </field>
                <field>
                    <name>price_unit</name>
                    <type>float</type>
                </field>
                <field>
                    <name>price_total</name>
                    <type>float</type>
                </field>
                <field>
                    <name>ticks_a</name>
                    <type>integer</type>
                    <length>3</length>
                </field>
                <field>
                    <name>ticks_b</name>
                    <type>integer</type>
                    <length>3</length>
                </field>
                <field>
                    <name>contact_id</name>
                    <type>text</type>
                    <length>40</length>
                </field>
                <field>
                    <name>contact_name</name>
                    <type>text</type>
                    <length>128</length>
                    <notnull>false</notnull>
                </field>
                <index>
                    <name>id</name>
                    <primary>true</primary>
                    <field>
                        <name>id</name>
                    </field>
                </index>
                <index>
                    <name>entry_id</name>
                    <field>
                        <name>entry_id</name>
                    </field>
                </index>
                <index>
                    <name>creation_time</name>
                    <field>
                        <name>creation_time</name>
                    </field>
                </index>
                <index>
                    <name>timestamp</name>
                    <field>
                        <name>timestamp</name>
                    </field>
                </index>                
                <index>
                    <name>connection::contact_id--contact::id</name>
                    <field>
                        <name>contact_id</name>
                    </field>
                    <foreign>true</foreign>
                    <reference>
                        <table>addressbook</table>
                        <field>id</field>
                    </reference>
                </index>
                <index>
                    <name>connection::line_id--line::id</name>
                    <field>
                        <name>line_id</name>
                    </field>
                    <foreign>true</foreign>
                    <reference>
                        <table>sipgate_line</table>
                        <field>id</field>
                    </reference>
                </index>
            </declaration>
        </table>
    </tables>
</application>